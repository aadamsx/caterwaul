(function(c){var b=function(e){var d=function(f){if(f.constructor===Array){for(var h=0,g=f.length,j=[];h<g;++h){j.push(d(f[h]))}return function(k){for(var l=j.length-1,m;l>=0;--l){if(m=j[l].call(this,k)){return m}}}}else{return f.constructor===String?d(c.parse(f)):f.constructor===c.syntax?e.call(this,f):f}};return d};c.pattern=b(function(d){return function(e){return d.match(e)}});c.expander=b(function(d){return function(e){return d.replace(e)}});c.alternatives=b(function(d){throw new Error("must use replacer functions with caterwaul.alternatives()")});c.reexpander=function(f){var d=c.expander(f);return function(e){var g=d.call(this,e);this.constructor===Function||console.log(this);return g&&this(g)}};var a=function(d){return function(f,h){var g=c.pattern(f),e=d(h);return function(i){var j=g.call(this,i);return j&&e.call(this,j)}}};c.replacer=a(c.expander);c.rereplacer=a(c.reexpander);c.macroexpand=function(d){return c(c.alternatives(Array.prototype.slice.call(arguments,1)))(d)}})(caterwaul);(function(a){a.anonymizer=function(){for(var d={},c=0,b=arguments.length;c<b;++c){d[arguments[c]]=a.gensym(arguments[c])}return function(e){return a.parse(e).replace(d)}}})(caterwaul);(function(a){a.js=function(q){var g=function(w){var E=w.data,t=E.charAt(0),y=a.syntax;if(t!=="'"&&t!=='"'||!/#\{[^\}]+\}/.test(E)){return false}for(var x=[],A=1,z=E.length-1,D=0,B=false,u=1,C;A<z;++A){if(D){if((C=E.charAt(A))==="}"){--D||x.push(E.substring(u,A))&&(u=A+1),B=false}else{D+=C==="{"}}else{if((C=E.charAt(A))==="#"){B=true}else{if(C==="{"&&B){x.push(E.substring(u,A-1)),u=A+1,++D}else{B=false}}}}x.push(E.substring(u,z));for(var v=new RegExp("\\\\"+t,"g"),A=0,z=x.length;A<z;++A){x[A]=A&1?this(a.parse(x[A].replace(v,t)).as("(")):new y(t+x[A]+t)}return new y("+",x).unflatten().as("(")};var e=a.rereplacer("_left(_args) = _right","_left = (function (_args) {return _right})"),d=a.rereplacer("_left(_var = arguments) = _right","_left = (function () {var _var = arguments; return _right})"),i=function(s){return d.call(this,s)||e.call(this,s)};var j=a.pattern("_modifier[_expression]"),l=a.pattern("_expression /_modifier"),p=a.pattern("_expression -_modifier"),h=a.pattern("_modifier in _expression"),b=a.pattern("_expression |_modifier"),f=a.pattern("_expression, _modifier"),n=a.pattern("_modifier._parameters"),k=a.pattern("_modifier[_parameters]"),o=a.pattern("_expression <_modifier> _parameters"),m=a.pattern("_expression -_modifier- _parameters"),c=function(x){var s=o.call(this,x)||m.call(this,x);if(s){for(var y=this.parameterized_modifiers,v=y.length-1,w;v>=0;--v){if(w=y[v].call(this,s)){return w}}}var u=j.call(this,x)||l.call(this,x)||p.call(this,x)||h.call(this,x)||b.call(this,x)||f.call(this,x);if(u){var t=n.call(this,u._modifier)||k.call(this,u._modifier);if(t){u._modifier=t._modifier;u._parameters=t._parameters;for(var y=this.parameterized_modifiers,v=y.length-1,w;v>=0;--v){if(w=y[v].call(this,u)){return w}}}else{for(var y=this.modifiers,v=y.length-1,w;v>=0;--v){if(w=y[v].call(this,u)){return w}}}}};var r=q?a(function(s){return q.call(this,s)||g.call(this,s)||s.length&&(c.call(this,s)||i.call(this,s))}):a(function(s){return g.call(this,s)||s.length&&(c.call(this,s)||i.call(this,s))});r.modifiers=[];r.parameterized_modifiers=[];return r}})(caterwaul);(function(a){a.words=function(c){var e=function(f,g){return function(h){return h._modifier.data===f&&g.call(this,h)}},b=function(f,g){c.modifiers.push(e(f,g))},d=function(f,g){c.parameterized_modifiers.push(e(f,g))};b("qs",function(f){return new a.ref(f._expression,"qs")});b("qse",function(f){return new a.ref(this(f._expression),"qse")});b("reexpand",function(f){return this(this(f._expression))});b("noexpand",function(f){return f._expression});b("raise",a.reexpander("(function () {throw _expression}).call(this)"));d("rescue",a.reexpander("(function () {try {return (_expression)} catch (e) {return (_parameters)}}).call(this)"));d("given",a.reexpander("(function (_parameters) {return _expression})"));d("bgiven",a.reexpander("(function (t, f) {return (function () {return f.apply(t, arguments)})})(this, (function (_parameters) {return _expression}))"));b("delay",a.reexpander("(function (t, f) {return (function () {return f.call(t)})})(this, (function () {return _expression}))"));b("lazy",a.reexpander("(function (t, f, v, vc) {return (function () {return vc ? v : (vc = true, v = f.call(t))})})(this, (function () {return _expression}))"));d("se",a.reexpander("(function (it) {return (_parameters), it}).call(this, (_expression))"));d("re",a.reexpander("(function (it) {return (_parameters)}).call(this, (_expression))"));d("where",a.reexpander("(function () {var _parameters; return (_expression)}).call(this)"));d("when",a.reexpander("((_parameters) && (_expression))"));d("unless",a.reexpander("(! (_parameters) && (_expression))"));return c}})(caterwaul);caterwaul.words(caterwaul.js())(caterwaul.precompiled_internal((function(){null;return(function(a){(function(){var d=a.anonymizer("S"),e=(function(g,f){return a.rereplacer(d(g),f.constructor===Function?(function(h){return f.call(this,h)}):d(f))}),b=(function(){var z=(function(M,N){return[e(("S[_xs "+(M)+""+(N)+"~_body]"),("S[_xs "+(M)+""+(N)+"S[_body]]")),e(("S[_xs "+(M)+""+(N)+"!~_body]"),("S[_xs "+(M)+""+(N)+"!S[_body]]")),e(("S[_xs "+(M)+""+(N)+"~!~_body]"),("S[_xs "+(M)+""+(N)+"~!S[_body]]"))]}),p=a.anonymizer("xs","ys","x","y","i","j","l","lj","r","o","k"),x=(function(M){return p(J(d(M)))}),g=d("(function (xs) {_body}).call(this, S[_xs])"),J=(function(M){return g.replace({_body:M})}),o=(function(M){return(function(){var N=x(M);return((function(O){return N.replace(C(O))}))}).call(this)}),H=o("for (var ys = [], _xi = 0, _xl = xs.length, _x; _xi < _xl; ++_xi) _x = xs[_xi], ys.push((_f));                                 return ys"),j=o("for (var          _xi = 0, _xl = xs.length, _x; _xi < _xl; ++_xi) _x = xs[_xi], (_f);                                          return xs"),B=o("for (var ys = [], _xi = 0, _xl = xs.length, _x; _xi < _xl; ++_xi) _x = xs[_xi], ys.push.apply(ys, ys.slice.call((_f)));        return ys"),r=o("for (var ys = [], _xi = 0, _xl = xs.length, _x; _xi < _xl; ++_xi) _x = xs[_xi], (_f) && ys.push(_x);                           return ys"),i=o("for (var ys = [], _xi = 0, _xl = xs.length, _x; _xi < _xl; ++_xi) _x = xs[_xi], (_f) || ys.push(_x);                           return ys"),f=o("for (var ys = [], _xi = 0, _xl = xs.length, _x, _y; _xi < _xl; ++_xi) _x = xs[_xi], (_y = (_f)) && ys.push(_y);                return ys"),K=o("for (var _x0 = xs[0], _xi = 1, _xl = xs.length, _x;            _xi < _xl; ++_xi) _x = xs[_xi], _x0 = (_f);                     return _x0"),E=o("for (var _xl = xs.length - 1, _xi = _xl - 1, _x0 = xs[_xi], _x; _xi >= 0; --_xi) _x = xs[_xi], _x0 = (_f);                     return _x0"),s=o("for (var ys = [], _x = xs, _xi = 0;                          _x !== null; ++_xi) ys.push(_x), _x = (_f);                       return ys"),D=o("for (var _x0 = (_init), _xi = 0, _xl = xs.length, _x;      _xi < _xl; ++_xi) _x = xs[_xi], _x0 = (_f);                         return _x0"),A=o("for (var _xl = xs.length - 1, _xi = _xl, _x0 = (_init), _x; _xi >= 0; --_xi) _x = xs[_xi], _x0 = (_f);                         return _x0"),y=o("for (var _x = xs[0], _xi = 0, _xl = xs.length, x; _xi < _xl; ++_xi) {_x = xs[_xi]; if (y = (_f)) return y} return false"),n=o("return xs.concat(S[_ys])"),F=o("for (var ys = S[_ys], pairs = [], i = 0, l = xs.length; i < l; ++i) pairs.push([xs[i], ys[i]]); return pairs"),h=o("for (var ys = S[_ys], pairs = [], i = 0, l = xs.length, lj = ys.length; i < l; ++i) for (var j = 0; j < lj; ++j) pairs.push([xs[i], ys[j]]);return pairs"),G=o("var r = {};        for (var _x in xs) if (Object.prototype.hasOwnProperty.call(xs, _x)) r[_f] = xs[_x];                        return r"),k=o("                   for (var _x in xs) if (Object.prototype.hasOwnProperty.call(xs, _x)) _f;                                    return xs"),w=o("var r = {};        for (var _x in xs) if (Object.prototype.hasOwnProperty.call(xs, _x) &&      (_f))  r[_x] = xs[_x];          return r"),m=o("var r = {};        for (var _x in xs) if (Object.prototype.hasOwnProperty.call(xs, _x) &&    ! (_f))  r[_x] = xs[_x];          return r"),v=o("var r = {}, x;     for (var _x in xs) if (Object.prototype.hasOwnProperty.call(xs, _x) && (x = (_f))) r[x]  = xs[_x];          return r"),t=o("var r = {}, _x;    for (var  k in xs) if (Object.prototype.hasOwnProperty.call(xs, k)) _x = xs[k], r[k] = (_f);                return r"),L=o("var _x;            for (var  k in xs) if (Object.prototype.hasOwnProperty.call(xs, k)) _x = xs[k], _f;                         return xs"),q=o("var r = {}, _x;    for (var  k in xs) if (Object.prototype.hasOwnProperty.call(xs, k)) _x = xs[k],        (_f) && (r[k] = _x); return r"),l=o("var r = {}, _x;    for (var  k in xs) if (Object.prototype.hasOwnProperty.call(xs, k)) _x = xs[k],        (_f) || (r[k] = _x); return r"),u=o("var r = {}, _x, x; for (var  k in xs) if (Object.prototype.hasOwnProperty.call(xs, k)) _x = xs[k], x = (_f), x && (r[k] =  x); return r"),C=(function(M){return a.merge({},M,I(M._var))}),I=(function(M){return(function(){var N=M&&M.data||"x";return({_x:N,_xi:(""+(N)+"i"),_xl:(""+(N)+"l"),_x0:(""+(N)+"0")})}).call(this)});return((function(){var N={"/":true},O=(function(Q,P){return e(d(("S[_xs "+(Q)+" _ys]")),P)}),M=(function(Q,R,P){return(function(){var S=Q&&("%"+(Q)+"");return((function(T){return(T.concat(z(S,R)))}).call(this,((function(T){return(((P.itbang)&&(T.push(e(("S[_xs "+(S)+""+(R)+"~![_init][_f]]"),P.itbang),e(("S[_xs "+(S)+""+(R)+"~!_var[_init][_f]]"),P.itbang))))),T}).call(this,((function(T){return(((P.ibang)&&(T.push(e(("S[_xs "+(S)+""+(R)+"![_init][_f]]"),P.ibang),e(("S[_xs "+(S)+""+(R)+"!_var[_init][_f]]"),P.ibang))))),T}).call(this,((function(T){return(((P.inormal)&&(T.push(e(("S[_xs "+(S)+""+(R)+"[_init][_f]]"),P.inormal),e(("S[_xs "+(S)+""+(R)+"_var[_init][_f]]"),P.inormal))))),T}).call(this,((function(T){return(((P.tbang)&&(T.push(e(("S[_xs "+(S)+""+(R)+"~![_f]]"),P.tbang),e(("S[_xs "+(S)+""+(R)+"~!_var[_f]]"),P.tbang))))),T}).call(this,((function(T){return(((P.bang)&&(T.push(e(("S[_xs "+(S)+""+(R)+"![_f]]"),P.bang),e(("S[_xs "+(S)+""+(R)+"!_var[_f]]"),P.bang))))),T}).call(this,((function(T){return(((P.normal)&&(T.push(e(("S[_xs "+(S)+""+(R)+"[_f]]"),P.normal),e(("S[_xs "+(S)+""+(R)+"_var[_f]]"),P.normal))))),T}).call(this,((function(T){return(((P.tbang||P.itbang)&&(T.push(e(("S[_xs "+(S)+""+(R)+"~!_f]"),("S[_xs "+(S)+""+(R)+"~![_f(x"+(N[R]?", x0":"")+")]]")))))),T}).call(this,((function(T){return(((P.bang||P.ibang)&&(T.push(e(("S[_xs "+(S)+""+(R)+"!_f]"),("S[_xs "+(S)+""+(R)+"![_f(x"+(N[R]?", x0":"")+")]]")))))),T}).call(this,((function(T){return(((P.normal||P.inormal)&&(T.push(e(("S[_xs "+(S)+""+(R)+"_f]"),("S[_xs "+(S)+""+(R)+"[_f(x"+(N[R]?", x0":"")+")]]")))))),T}).call(this,([])))))))))))))))))))))}).call(this)});return([e("S[_x]","_x"),e("S[(_x)]","(S[_x])"),e("S[_x[_y]]","S[_x][S[_y]]"),e("S[[_x]]","[S[_x]]"),e("S[_x, _y]","S[_x], S[_y]"),M("","|",{normal:y}),M("","*",{normal:H,bang:j,tbang:B}),O("+",n),O("^",F),M("","%",{normal:r,bang:i,tbang:f}),O("-",h),M("","/",{normal:K,bang:E,tbang:s,inormal:D,ibang:A}),M("k","*",{normal:G,bang:k}),M("v","*",{normal:t,bang:L}),M("k","%",{normal:w,bang:m,tbang:v}),M("v","%",{normal:q,bang:l,tbang:u})])}).call(this))}).call(this),c=(function(){var h=(function(n){return i.replace(a.merge({_lower:"0",_step:"1"},n))}),i=d("(function (i, u, s) {if ((u - i) * s <= 0) return [];for (var r = [], d = u - i; d > 0 ? i < u : i > u; i += s) r.push(i); return r})((_lower), (_upper), (_step))"),o=d("(function (o) {_body}).call(this, (S[_o]))"),k=(function(n){return o.replace({_body:n})}),g=(function(n){return(function(){var p=k(d(n));return((function(q){return p.replace(q)}))}).call(this)}),m=g("var ks = []; for (var k in o) Object.prototype.hasOwnProperty.call(o, k) && ks.push(k); return ks"),l=g("var vs = []; for (var k in o) Object.prototype.hasOwnProperty.call(o, k) && vs.push(o[k]); return vs"),f=g("var ps = []; for (var k in o) Object.prototype.hasOwnProperty.call(o, k) && ps.push([k, o[k]]); return ps"),j=g("for (var r = {}, i = 0, l = o.length, x; i < l; ++i) x = o[i], r[x[0]] = x[1]; return r");return([e("S[n[_upper]]",h),e("S[_o /keys]",m),e("S[_o |object]",j),e("S[n[_lower, _upper]]",h),e("S[_o /values]",l),e("S[_o -object]",j),e("S[n[_lower, _upper, _step]]",h),e("S[_o /pairs]",f),e("S[_o /object]",j)])}).call(this);return(a.seq=(function(f){return(function(){var h=d("S[_x]"),g=a(a.alternatives(b.concat(c)));return((function(i){return(i.modifiers.push((function(j){return((j._modifier.data==="seq")&&((function(k){return(((k)&&(this(k))))}).call(this,(g.call(g,h.replace({_x:j._expression}))))))}))),i}).call(this,(f)))}).call(this)}))}).call(this)})}).call(this)))(caterwaul);caterwaul.js_all=function(){return this.seq(this.words(this.js()))};