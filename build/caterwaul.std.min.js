caterwaul.module("std.macro",function(d){var c=function(g){var f=function(h){if(h.constructor===Array){for(var k=0,j=h.length,m=[];k<j;++k){m.push(f(h[k]))}return function(l){for(var n=m.length-1,o;
n>=0;--n){if(o=m[n].call(this,l)){return o}}}}else{return h.constructor===String?f(d.parse(h)):h.constructor===d.syntax?g.call(this,h):h}};return f};d.pattern=c(function(f){return function(g){return f.match(g)
}});d.expander=c(function(f){return function(g){return f.replace(g)}});d.alternatives=c(function(f){throw new Error("must use replacer functions with caterwaul.alternatives()")
});d.reexpander=function(g){var f=d.expander(g);return function(h){var i=f.call(this,h);return i&&this(i)}};var b=function(f){return function(h,j){var i=d.pattern(h),g=f(j);
return function(k){var l=i.call(this,k);return l&&g.call(this,l)}}};d.replacer=b(d.expander);d.rereplacer=b(d.reexpander);var a=d.parse("new caterwaul.syntax(_data)"),e=d.parse("new caterwaul.syntax(_data, _xs)");
d.syntax_to_expression=function(g){if(g.length){for(var f=new d.syntax(","),j=0,h=g.length;j<h;++j){f.push(d.syntax_to_expression(g[j]))}return e.replace({_data:'"'+g.data.replace(/"/g,'\\"').replace(/\n/g,"\\n")+'"',_xs:f.unflatten()})
}else{return a.replace({_data:'"'+g.data.replace(/"/g,'\\"').replace(/\n/g,"\\n")+'"'})}};d.macroexpand=function(f){return d(d.alternatives(Array.prototype.slice.call(arguments,1)))(f)
}});caterwaul.module("std.anon",function(a){a.anonymizer=function(){for(var d={},c=0,b=arguments.length;c<b;++c){d[arguments[c]]=a.gensym(arguments[c])}return function(e){return a.parse(e).replace(d)
}}});caterwaul.module("std.js",function(a){a.js=function(c){var f=function(I){var Q=I.data,F=Q.charAt(0),K=a.syntax;if(F!=="'"&&F!=='"'||!/#\{[^\}]+\}/.test(Q)){return false
}for(var J=[],R=[],M=1,L=Q.length-1,P=0,N=false,G=1,O;M<L;++M){if(P){if((O=Q.charAt(M))==="}"){--P||(J.push(Q.substring(G,M)),R.push(true))&&(G=M+1),N=false}else{P+=O==="{"
}}else{if((O=Q.charAt(M))==="#"){N=true}else{if(O==="{"&&N){J.push(Q.substring(G,M-1)),R.push(false),G=M+1,++P}else{N=false}}}}J.push(Q.substring(G,L)),R.push(false);
for(var H=new RegExp("\\\\"+F,"g"),M=0,L=J.length;M<L;++M){J[M]=R[M]?this(a.parse(J[M].replace(H,F)).as("(")):new K(F+J[M]+F)}return new K("+",J).unflatten().as("(")
};var B=a.parse("var _x = _y"),E=a.parse("_x = _y"),y=a.parse("result"),D=a.parse("function (_formals) {_befores; var result = _result; _afters; return result}"),z=a.parse("function (_formals) {_befores; return _result}"),g=a.parse("_f = _x"),A=function(F){return F.is_empty()&&F.data==="result"
},p=a.rereplacer("_f(_xs) = _y",function(O){for(var P=[],T=[],U=[],F=O._xs.flatten(","),N=0,L=F.length;N<L;++N){(U.length||F[N].contains(A)?U:T.length||F[N].length?T:P).push(F[N])
}for(var K=[T,U],N=0,L=K.length;N<L;++N){for(var J=K[N],M=0,R=J.length,I;M<R;++M){J[M]=(I=E.match(J[M]))&&I._x.is_empty()?B.replace(I):J[M].as("(")}}var Q=P.length?new a.syntax(",",P).unflatten():a.empty,H=T.length?new a.syntax(";",T).unflatten():a.empty,G=U.length?new a.syntax(";",U).unflatten():a.empty,S=g.replace({_f:O._f,_x:U.length?D:z});
return S.replace({_formals:Q,_befores:H,_afters:G,_result:O._y})});var q=function(G){var I=G.data,H,F;if((I==="/"||I==="|")&&(H=G[0]).data===I&&H[1]&&H[1].data==="u-"&&(F=H[1][0])){return new a.syntax("()",F,this(G[0][0]).flatten(I).push(this(G[1])).with_data(",").unflatten())
}};var x=function(I){var K=I.data,J,H;if((K==="/"||K==="|")&&(J=I[0]).data===K&&J[1]&&J[1].data==="u~"&&(H=J[1][0])){var G=[].slice.call(this(I[0][0]).flatten(K)),F=G.shift();
return new a.syntax("()",new a.syntax(".",new a.syntax("(",F),H),new a.syntax(",",G,this(I[1])).unflatten())}};var l=a.parse("_f(_x)"),h=a.rereplacer("_x /!_f",function(F){return l.replace({_f:F._f,_x:this(F._x).flatten("/").with_data(",").unflatten()})
});var j=a.pattern("_literal._modifier"),w=function(G,H,F){var I=G.literal_modifiers[H];return I.hasOwnProperty(F)&&I[F]},n=function(H){var G=j.call(this,H),F,I;
if(G&&(F=G._literal)&&(I=F.is_identifier()?w(this,"identifier",G._modifier.data):F.is_array()?w(this,"array",G._modifier.data):F.is_regexp()?w(this,"regexp",G._modifier.data):F.is_number()?w(this,"number",G._modifier.data):F.is_string()?w(this,"string",G._modifier.data):null)){return I.call(this,F)
}};var s=a.pattern("_modifier[_expression]"),i=a.pattern("_expression /_modifier"),u=a.pattern("_expression -_modifier"),C=a.pattern("_modifier in _expression"),r=a.pattern("_expression |_modifier"),t=a.pattern("_expression, _modifier"),o=a.pattern("_modifier._parameters"),k=a.pattern("_modifier[_parameters]"),v=a.pattern("_expression <_modifier> _parameters"),e=a.pattern("_expression -_modifier- _parameters"),b=function(K){var F,G=v.call(this,K)||e.call(this,K);
if(G&&this.parameterized_modifiers.hasOwnProperty(F=G._modifier.data)){var J=this.parameterized_modifiers[F].call(this,G);if(J){return J}}var I=s.call(this,K)||i.call(this,K)||u.call(this,K)||C.call(this,K)||r.call(this,K)||t.call(this,K);
if(I){var H=o.call(this,I._modifier)||k.call(this,I._modifier);if(H){I._modifier=H._modifier;I._parameters=H._parameters;return this.parameterized_modifiers.hasOwnProperty(F=I._modifier.data)&&this.parameterized_modifiers[F].call(this,I)
}else{return this.modifiers.hasOwnProperty(F=I._modifier.data)&&this.modifiers[F].call(this,I)}}};var d=function(F){return f.call(this,F)||n.call(this,F)||F.length&&(b.call(this,F)||p.call(this,F)||q.call(this,F)||x.call(this,F)||h.call(this,F))
},m=c?a(function(F){return c.call(this,F)||d.call(this,F)}):a(d);m.modifiers={};m.parameterized_modifiers={};m.literal_modifiers={regexp:{},array:{},string:{},number:{},identifier:{}};
return m}});caterwaul.module("std.js-literals",function(a){a.js_literals=function(c){var b=a.parse("function (_) {return _body}");(function(d){d.x=a.reexpander(function(f){return f.with_data(f.data.replace(/\s+/g,""))
});var e=a.parse("_regexp.exec(_)");d.qf=function(f){return b.replace({_body:e.replace({_regexp:f})})}})(c.literal_modifiers.regexp);(function(d){d.qw=a.reexpander(function(k){for(var m=new a.syntax("["),e=new a.syntax(","),g=k.data.charAt(0),j=k.as_escaped_string().split(/\s+/),h=0,f=j.length;
h<f;++h){e.push(new a.syntax(g+j[h]+g))}return m.push(e.unflatten())});d.qh=a.reexpander(function(k){for(var m=new a.syntax("{"),e=new a.syntax(","),g=k.data.charAt(0),j=k.as_escaped_string().split(/\s+/),h=0,f=j.length;
h<f;h+=2){e.push(new a.syntax(":",new a.syntax(g+j[h]+g),new a.syntax(g+j[h+1]+g)))}return m.push(e.unflatten())});d.qr=a.reexpander(function(e){return e.with_data("/"+e.as_escaped_string().replace(/\//g,"\\/")+"/")
});d.qs=function(e){return new a.expression_ref(a.syntax_to_expression(a.parse(e.as_unescaped_string())),"qs")};d.qf=a.reexpander(function(e){return b.replace({_body:a.parse(e.as_unescaped_string())})
})})(c.literal_modifiers.string);return c}});caterwaul.module("std.words",function($){var scope_template=$.parse("(function () {var _variables; return (_expression)}).call(this)");
$.words=function(caterwaul_function){$.merge(caterwaul_function.modifiers,$.words.modifiers);$.merge(caterwaul_function.parameterized_modifiers,$.words.parameterized_modifiers);
return caterwaul_function};$.words.modifiers={qs:function(match){return new $.expression_ref($.syntax_to_expression(match._expression),"qs")},qse:function(match){return new $.expression_ref($.syntax_to_expression(this(match._expression)),"qse")
},reexpand:function(match){return this(this(match._expression))},noexpand:function(match){return match._expression},raise:$.reexpander("(function () {throw _expression}).call(this)"),eval:function(match){return new $.ref($.compile(this(match._expression)),"eval")
},delay:$.reexpander("(function (t, f) {return (function () {return f.call(t)})})(this, (function () {return _expression}))"),lazy:$.reexpander("(function (t, f, v, vc) {return (function () {return vc ? v : (vc = true, v = f.call(t))})})(this, (function () {return _expression}))"),capture:function(match){for(var comma=new $.syntax(","),bindings=match._expression.flatten(","),i=0,l=bindings.length;
i<l;++i){comma.push(this(bindings[i]).with_data(":"))}return new $.syntax("{",comma.unflatten())},wcapture:function(match){for(var e=this(match._expression),comma=new $.syntax(","),bindings=e.flatten(","),node,i=0,l=bindings.length;
i<l;++i){(node=this(bindings[i]))[1]=node[0],comma.push(node.with_data(":"))}return scope_template.replace({_variables:e,_expression:new $.syntax("{",comma.unflatten())})
}};$.words.parameterized_modifiers={given:$.reexpander("(function (_parameters) {return _expression})"),bgiven:$.reexpander("(function (t, f) {return (function () {return f.apply(t, arguments)})})(this, (function (_parameters) {return _expression}))"),rescue:$.reexpander("(function () {try {return (_expression)} catch (e) {return (_parameters)}}).call(this)"),se:$.reexpander("(function (it) {return (_parameters), it}).call(this, (_expression))"),re:$.reexpander("(function (it) {return (_parameters)}).call(this, (_expression))"),where:$.reexpander("(function () {var _parameters; return (_expression)}).call(this)"),using:$.reexpander(function(match){var m=this(match._parameters),o=$.compile(m),comma=new $.syntax(","),expression_ref=new $.expression_ref(m);
for(var k in o){Object.prototype.hasOwnProperty.call(o,k)&&/^[_$a-zA-Z][_$0-9a-zA-Z]*$/.test(k)&&!this.modifiers.hasOwnProperty(k)&&!this.parameterized_modifiers.hasOwnProperty(k)&&comma.push(new $.syntax("=",k,new $.syntax(".",expression_ref,k)))
}return scope_template.replace({_variables:comma.unflatten(),_expression:match._expression})}),when:$.reexpander("((_parameters) && (_expression))"),and:$.reexpander("((_expression) && (_parameters))"),unless:$.reexpander("(! (_parameters) && (_expression))"),or:$.reexpander("((_expression) || (_parameters))")}
});caterwaul.module("std.seq",function(a){(function(){var d=a.anonymizer("S"),e=function(g,f){return a.rereplacer(d(g),d(f))},b=(function(){var r=a.anonymizer("x","y","i","j","l","lj","r","o","k"),g=d(ref_h_lI0RQCId5TmGAuaYsayKZD),J=function(M){return g.replace({_body:M})
},h=function(M){return r(J(d(M)))},I=h(ref_i_lI0RQCId5TmGAuaYsayKZD),l=h(ref_j_lI0RQCId5TmGAuaYsayKZD),D=h(ref_k_lI0RQCId5TmGAuaYsayKZD),q=h(ref_l_lI0RQCId5TmGAuaYsayKZD),u=h(ref_m_lI0RQCId5TmGAuaYsayKZD),j=h(ref_n_lI0RQCId5TmGAuaYsayKZD),f=h(ref_o_lI0RQCId5TmGAuaYsayKZD),k=h(ref_p_lI0RQCId5TmGAuaYsayKZD),K=h(ref_q_lI0RQCId5TmGAuaYsayKZD),F=h(ref_r_lI0RQCId5TmGAuaYsayKZD),v=h(ref_s_lI0RQCId5TmGAuaYsayKZD),E=h(ref_t_lI0RQCId5TmGAuaYsayKZD),C=h(ref_u_lI0RQCId5TmGAuaYsayKZD),B=h(ref_v_lI0RQCId5TmGAuaYsayKZD),A=h(ref_w_lI0RQCId5TmGAuaYsayKZD),t=h(ref_x_lI0RQCId5TmGAuaYsayKZD),p=d(ref_y_lI0RQCId5TmGAuaYsayKZD),G=h(ref_z_lI0RQCId5TmGAuaYsayKZD),i=h(ref_10_lI0RQCId5TmGAuaYsayKZD),H=h(ref_11_lI0RQCId5TmGAuaYsayKZD),m=h(ref_12_lI0RQCId5TmGAuaYsayKZD),z=h(ref_13_lI0RQCId5TmGAuaYsayKZD),o=h(ref_14_lI0RQCId5TmGAuaYsayKZD),y=h(ref_15_lI0RQCId5TmGAuaYsayKZD),w=h(ref_16_lI0RQCId5TmGAuaYsayKZD),L=h(ref_17_lI0RQCId5TmGAuaYsayKZD),s=h(ref_18_lI0RQCId5TmGAuaYsayKZD),n=h(ref_19_lI0RQCId5TmGAuaYsayKZD),x=h(ref_1a_lI0RQCId5TmGAuaYsayKZD);
return((function(){var ao=function(ap){return(function(){throw new Error(ap)}).call(this)},ab=function(ar,aq,ap,au,at){return ar?ar.replace({_f:ap,_init:au}).replace(a.merge({_s:aq},at)):ao(("unsupported sequence operator or modifiers used on "+(ap)+""))
},T=function(ap){return function(aq){return(function(){var au=aq._xs,aw=this,av=function(ax){return function(ay,az){return ab(ax,au,ay,null,az)}},at=function(ax){return function(ay,aA,az){return ab(ax,au,ay,aA,az)
}},ar=function(ax,ay){return function(az){return al(az,aw,av(ax),at(ay))}};return(X(aq._thing,ar(ap.normal,ap.inormal),ar(ap.bang,ap.ibang),ar(ap.tbang,ap.itbang)))
}).call(this)}},ae=T({normal:I,bang:l,tbang:D,itbang:q}),ah=T({normal:u,bang:j,tbang:f,itbang:k}),ac=T({normal:K,bang:F,tbang:v,inormal:E,ibang:C,itbang:B}),U=T({normal:H,bang:m}),af=T({normal:z,bang:o,tbang:y}),V=T({normal:w,bang:L}),ad=T({normal:s,bang:n,tbang:x}),M=T({normal:A,bang:t}),S=d(ref_1b_lI0RQCId5TmGAuaYsayKZD),Y=d(ref_1c_lI0RQCId5TmGAuaYsayKZD),ak=d(ref_1d_lI0RQCId5TmGAuaYsayKZD),ag=d(ref_1e_lI0RQCId5TmGAuaYsayKZD),O=d(ref_1f_lI0RQCId5TmGAuaYsayKZD),aj=d(ref_1g_lI0RQCId5TmGAuaYsayKZD),Q={_x:"x",_x0:"x0",_xi:"xi",_xl:"xl",_xs:"xs",_xr:"xr"},ai=function(ap){return{_x:ap,_x0:(""+(ap)+"0"),_xi:(""+(ap)+"i"),_xl:(""+(ap)+"l"),_xs:(""+(ap)+"s"),_xr:(""+(ap)+"r")}
},an=d(ref_1h_lI0RQCId5TmGAuaYsayKZD),W=function(ap){return an.replace({_f:ap})},N=d(ref_1i_lI0RQCId5TmGAuaYsayKZD),R=function(aq,ap){return N.replace(aq).replace({_f:ap})
},am=d(ref_1j_lI0RQCId5TmGAuaYsayKZD),aa=function(ap){return am.replace({_x:ap})},al=function(ap,aq,ar,at){return(function(){var au=function(aA){return aq.call(aq,aa(aA))
},ay=function(aA,aB){return ar(au(aA),aB)},ax=function(aB,aA,aC){return at(au(aB),aA,aC)},az=function(aA,aB){return ar(R(aB,aA),aB)},av=function(aB,aA,aC){return at(R(aC,aB),aA,aC)
},aw=null;return(((aw=aj.match(ap))?al(aw._x,aq,ay,ax):(aw=O.match(ap))?al(aw._x,aq,az,av):(aw=ag.match(ap))?at(aw._x,aw._init,ai(aw._var)):(aw=ak.match(ap))?at(aw._x,aw._init,Q):(aw=Y.match(ap))?ar(aw._x,ai(aw._var)):(aw=S.match(ap))?ar(aw._x,Q):ar(W(ap),Q)))
}).call(this)},P=d("~!_x"),Z=d("!_x"),X=function(ap,ar,aq,at){return(function(){var au=null;return(((au=P.match(ap))?at(au._x):(au=Z.match(ap))?aq(au._x):ar(ap)))
}).call(this)};return([e(ref_1k_lI0RQCId5TmGAuaYsayKZD,ref_1l_lI0RQCId5TmGAuaYsayKZD),e(ref_1m_lI0RQCId5TmGAuaYsayKZD,p),e(ref_1n_lI0RQCId5TmGAuaYsayKZD,G),e(ref_1o_lI0RQCId5TmGAuaYsayKZD,i),e(ref_1p_lI0RQCId5TmGAuaYsayKZD,ref_1q_lI0RQCId5TmGAuaYsayKZD),e(ref_1r_lI0RQCId5TmGAuaYsayKZD,ref_1s_lI0RQCId5TmGAuaYsayKZD),e(ref_1t_lI0RQCId5TmGAuaYsayKZD,ref_1u_lI0RQCId5TmGAuaYsayKZD),e(ref_1v_lI0RQCId5TmGAuaYsayKZD,ref_1w_lI0RQCId5TmGAuaYsayKZD),e(ref_1x_lI0RQCId5TmGAuaYsayKZD,ref_1y_lI0RQCId5TmGAuaYsayKZD),e(ref_1z_lI0RQCId5TmGAuaYsayKZD,ref_20_lI0RQCId5TmGAuaYsayKZD),e(ref_21_lI0RQCId5TmGAuaYsayKZD,ref_22_lI0RQCId5TmGAuaYsayKZD),e(ref_23_lI0RQCId5TmGAuaYsayKZD,ref_24_lI0RQCId5TmGAuaYsayKZD),e(ref_25_lI0RQCId5TmGAuaYsayKZD,ref_26_lI0RQCId5TmGAuaYsayKZD),e(ref_27_lI0RQCId5TmGAuaYsayKZD,ref_28_lI0RQCId5TmGAuaYsayKZD),e(ref_29_lI0RQCId5TmGAuaYsayKZD,ref_2a_lI0RQCId5TmGAuaYsayKZD),e(ref_2b_lI0RQCId5TmGAuaYsayKZD,ref_2c_lI0RQCId5TmGAuaYsayKZD),e(ref_2d_lI0RQCId5TmGAuaYsayKZD,ah),e(ref_2e_lI0RQCId5TmGAuaYsayKZD,ae),e(ref_2f_lI0RQCId5TmGAuaYsayKZD,ac),e(ref_2g_lI0RQCId5TmGAuaYsayKZD,M),e(ref_2h_lI0RQCId5TmGAuaYsayKZD,U),e(ref_2i_lI0RQCId5TmGAuaYsayKZD,V),e(ref_2j_lI0RQCId5TmGAuaYsayKZD,af),e(ref_2k_lI0RQCId5TmGAuaYsayKZD,ad)])
}).call(this))}).call(this),c=(function(){var i=function(n){return j.replace(a.merge({_l:"0",_step:"1"},n))},h=function(n){return k.replace(a.merge({_l:"0",_step:"1"},n))
},j=d(ref_2l_lI0RQCId5TmGAuaYsayKZD),k=d(ref_2m_lI0RQCId5TmGAuaYsayKZD),r=d(ref_2n_lI0RQCId5TmGAuaYsayKZD),o=function(n){return r.replace({_body:n})},g=function(n){return(function(){var s=o(d(n));
return((function(t){return s.replace(t)}))}).call(this)},q=g(ref_2o_lI0RQCId5TmGAuaYsayKZD),p=g(ref_2p_lI0RQCId5TmGAuaYsayKZD),f=g(ref_2q_lI0RQCId5TmGAuaYsayKZD),l=g(ref_2r_lI0RQCId5TmGAuaYsayKZD),m=g(ref_2s_lI0RQCId5TmGAuaYsayKZD);
return([e(ref_2t_lI0RQCId5TmGAuaYsayKZD,i),e(ref_2u_lI0RQCId5TmGAuaYsayKZD,h),e(ref_2v_lI0RQCId5TmGAuaYsayKZD,i),e(ref_2w_lI0RQCId5TmGAuaYsayKZD,h),e(ref_2x_lI0RQCId5TmGAuaYsayKZD,i),e(ref_2y_lI0RQCId5TmGAuaYsayKZD,h),e(ref_2z_lI0RQCId5TmGAuaYsayKZD,q),e(ref_30_lI0RQCId5TmGAuaYsayKZD,l),e(ref_31_lI0RQCId5TmGAuaYsayKZD,m),e(ref_32_lI0RQCId5TmGAuaYsayKZD,p),e(ref_33_lI0RQCId5TmGAuaYsayKZD,l),e(ref_34_lI0RQCId5TmGAuaYsayKZD,m),e(ref_35_lI0RQCId5TmGAuaYsayKZD,f),e(ref_36_lI0RQCId5TmGAuaYsayKZD,l),e(ref_37_lI0RQCId5TmGAuaYsayKZD,m)])
}).call(this);return(a.seq=function(f){return(function(){var h=d("S[_x]"),g=a(a.alternatives(b.concat(c)));return((function(i){return(i.modifiers.seq=function(j){return(function(k){return(((k)&&(this(k))))
}).call(this,(g.call(g,h.replace({_x:j._expression}))))}),i}).call(this,(f)))}).call(this)})}).call(this)});caterwaul.module("std",function(a){a.js_all=function(){return this("js js_literals words seq")
}});