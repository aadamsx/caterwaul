sdocp('modules/caterwaul.destructure.js.sdoc', 'First-class destructuring binds | Spencer Tipping\nLicensed under the terms of the MIT source code license\n\nIntroduction.\nLots of languages support destructuring binds of some sort, and many have pattern matching. Caterwaul wouldn\'t be awesome if it didn\'t have these things, so I\'m taking it one step further by\nadding first-class destructuring binds and pattern matching. The difference here is that most languages have a hard time letting you specify an arbitrary language for unpacking. Caterwaul, on\nthe other hand, supports this by bridging the barrier between syntax and runtime code. (For this reason it is quite slow and ends up being memoized.)\n\nThis isn\'t quite as trivial as it sounds. The hardest problem is knowing ahead-of-time which variables end up getting bound. For example:\n\n| value /match[ {foo: bar} > bar\n              | {bif: baz} > baz + 1]\n\nThis fails because the value being bound isn\'t obvious. That is, \'bar\' in the first expression and \'baz\' in the second might refer to closure variables, not to the destructuring-bind value;\nand until the resolution is done at runtime it isn\'t clear what these variables should mean. We also don\'t have the luxury of compiling arbitrary code at runtime since the scope is presumably\ninaccessible (and it would be hideously slow). So the notation must have two properties:\n\n| 1. Newly-bound variables must be statically enumerable from a pattern (so that we don\'t dynamically compile the expansion).\n  2. Variables must derive their values in a pure way (so that the destructuring function can be dynamically compiled and memoized).\n\n  Syntax.\n  Matching is done sequentially; if the first case matches, then take it; otherwise proceed to the second and so forth. It\'s similar to a Lisp (cond ...) form this way. So there is clearly a\n  sequence component, and that probably makes sense to denote using commas.\n\n  The more difficult aspect is the infix binding operator. This should be very low precedence, something like =, but work even with rvalue (unassignable) left operands.\n');