sdocp('sdoc::js::modules/caterwaul.parser.test/dsl', 'DSL tests for the caterwaul parser.\n\ntest(\'caterwaul.parser.dsl\', function () {\n  var c = caterwaul.clone(\'std parser\');\n\n  c(function (eq) {\n    var bind_test = peg[c(\'a\')];\n    eq(bind_test(\'a\'), \'a\');\n\n    eq(peg[c(\'a\') % c(\'b\')](\'ab\').join(\',\'), \'a,b\');\n    eq(peg[c(\'a\') % (c(\'b\') / c(\'c\'))](\'ab\').join(\',\'), \'a,b\');\n    eq(peg[c(\'a\') % (c(\'b\') / c(\'c\'))](\'ac\').join(\',\'), \'a,c\');\n\n    eq(peg[c(\'a\') % c(\'b\') % c(\'c\')](\'abc\').join(\'|\'), \'a|b|c\');\n\n    eq(peg[c(\'a\') % c(\'b\')[0]](\'abbb\').join(\'|\'), \'a|b,b,b\');\n    eq(peg[c(\'a\') % c(\'b\')[0]](\'ab\').join(\'|\'), \'a|b\');\n    eq(peg[c(\'a\') % c(\'b\')[1]](\'ab\').join(\'|\'), \'a|b\');\n    eq(peg[c(\'a\') % c(\'b\')[2]](\'ab\'), false);\n\n    eq(peg[c(\'a\') % c(\'b\')[0, 3]](\'abbb\').join(\'|\'), \'a|b,b,b\');\n    eq(peg[c(\'a\') % c(\'b\')[0, 2]](\'abbb\').join(\'|\'), \'a|b,b\');\n    eq(peg[c(\'a\') % c(\'b\')[0, 1]](\'abbb\').join(\'|\'), \'a|b\');\n    eq(peg[c(\'a\') % c(\'b\')[1, 1]](\'abbb\').join(\'|\'), \'a|b\');\n\n    eq(peg[c(\'a\') % [c(\'b\') / c(\'c\')] % c(\'d\') >> fn[xs][xs.join(\'.\')]](\'abd\'), \'a.b.d\');\n    eq(peg[c(\'a\') % [c(\'b\') / c(\'c\')] % c(\'d\') >> fn[xs][xs.join(\'.\')]](\'acd\'), \'a.c.d\');\n    eq(peg[c(\'a\') % [c(\'b\') / c(\'c\')] % c(\'d\') >> fn[xs][xs.join(\'.\')]](\'ad\'), \'a.false.d\');\n    eq(peg[c(\'a\') % [c(\'b\') / c(\'c\')] % c(\'d\') >> fn[xs][xs.join(\'.\')]](\'ab\'), false);\n    eq(peg[c(\'a\') % [c(\'b\') / c(\'c\')] % c(\'d\') >> fn[xs][xs.join(\'.\')]](\'ac\'), false);\n\n    eq(peg[c(\'a\') >> fn[x][x.length]](\'a\'), 1);\n\n    eq(peg[c(\'a\') % c(\'b\')[1] >> fn[xs][\'#{xs.length}|#{xs.join("")}\']](\'abbbb\'), \'2|ab,b,b,b\');\n    eq(peg[c(\'a\') % c(\'b\')[1] >> fn[xs][\'#{xs.length}|#{xs.join("")}\']](\'ab\'), \'2|ab\');\n    eq(peg[c(\'a\') % c(\'b\')[1] >> fn[xs][\'#{xs.length}|#{xs.join("")}\']](\'a\'), false);\n  })(eq);\n});');