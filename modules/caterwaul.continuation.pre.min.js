// Caterwaul JS | Spencer Tipping
// Licensed under the terms of the MIT source code license
caterwaul.configuration('continuation.core',function (gensym_2_gmjsuzge_e36heg){this.shallow('continuation',{})}).tconfiguration('std','continuation.unwind',caterwaul.precompiled_internal((function (){var gensym_2_gmjsuzge_e36heq=caterwaul.parse('unwind_protect[_][_]');
var gensym_2_gmjsuzge_e36het=caterwaul.parse('_f((function (gensym_2_gmjsuzge_e36her){return (function (){return (function (e){return _escape}).apply(gensym_2_gmjsuzge_e36her,arguments)})})(this),(function (gensym_2_gmjsuzge_e36hes){return (function (){return (function (){return _body}).apply(gensym_2_gmjsuzge_e36hes,arguments)})})(this))');
var gensym_2_gmjsuzge_e36heu=caterwaul.parse('caterwaul.continuation.unwind_protect');
var gensym_2_gmjsuzge_e36hev=caterwaul.parse('unwind[_]');
var gensym_2_gmjsuzge_e36hew=caterwaul.parse('caterwaul.continuation.unwind(_e)');
return (function (gensym_2_gmjsuzge_e36heh){((function (_){return _.unwind_protect=function (escape,f,gensym_2_gmjsuzge_e36hei){try {return f()}catch (e){return escape(e)}},_.unwind=function (e,gensym_2_gmjsuzge_e36hej){throw e},_})).call(this,this.configure('std.fn continuation.core').continuation);
this.rmacro(gensym_2_gmjsuzge_e36heq,(function (escape,body){return gensym_2_gmjsuzge_e36het.replace({_f:gensym_2_gmjsuzge_e36heu,_escape:escape,_body:body})})).rmacro(gensym_2_gmjsuzge_e36hev,(function (e){return gensym_2_gmjsuzge_e36hew.replace({_e:e})}))})})())).tconfiguration('std','continuation.cps',caterwaul.precompiled_internal((function (){var gensym_2_gmjsuzge_e36hey=caterwaul.parse('(function (_){return _f}).call(this,_c)');
var gensym_2_gmjsuzge_e36hez=caterwaul.clone('std.qs std.qg std.bind std.lvalue std.cond std.fn std.obj std.ref std.string std');
var gensym_2_gmjsuzge_e36hf0=caterwaul.parse('_f[_v][_b]');
var gensym_2_gmjsuzge_e36hf1=caterwaul.parse('fb');
var gensym_2_gmjsuzge_e36hf2=caterwaul.parse('fn');
var gensym_2_gmjsuzge_e36hf4=caterwaul.parse('l/_form[_,_< -_] in _');
var gensym_2_gmjsuzge_e36hf5=gensym_2_gmjsuzge_e36hez;
var gensym_2_gmjsuzge_e36hf6=caterwaul.parse('l/_form[_< -_] in _');
var gensym_2_gmjsuzge_e36hf7=gensym_2_gmjsuzge_e36hez;
var gensym_2_gmjsuzge_e36hf8=caterwaul.parse('l/_form[_,_< -_][_]');
var gensym_2_gmjsuzge_e36hf9=gensym_2_gmjsuzge_e36hez;
var gensym_2_gmjsuzge_e36hfa=caterwaul.parse('l/_form[_< -_][_]');
var gensym_2_gmjsuzge_e36hfb=gensym_2_gmjsuzge_e36hez;
var gensym_2_gmjsuzge_e36hf3=caterwaul.parse('l/cps[cs][_f]');
var gensym_2_gmjsuzge_e36hfc=caterwaul.parse('_/_form[_]');
var gensym_2_gmjsuzge_e36hfd=caterwaul.parse('_f/_form._[_b]');
var gensym_2_gmjsuzge_e36hfe=caterwaul.parse('_/_form._[_]');
var gensym_2_gmjsuzge_e36hff=caterwaul.parse('(function (_){return _f}).call(this,_c)');
var gensym_2_gmjsuzge_e36hfg=gensym_2_gmjsuzge_e36hez;
var gensym_2_gmjsuzge_e36hfh=caterwaul.parse('_f[_v][_b]');
var gensym_2_gmjsuzge_e36hfi=caterwaul.parse('fb');
var gensym_2_gmjsuzge_e36hfj=caterwaul.parse('fn');
var gensym_2_gmjsuzge_e36hfk=caterwaul.parse('cps');
var gensym_2_gmjsuzge_e36hfl=caterwaul.parse('cpb');
var gensym_2_gmjsuzge_e36hfm=caterwaul.parse('cps');
var gensym_2_gmjsuzge_e36hfn=caterwaul.parse('cpb');
return (function (gensym_2_gmjsuzge_e36hek){(function (){var cps_convert=(function (v,f,b,bound){return gensym_2_gmjsuzge_e36hey.replace({_c:gensym_2_gmjsuzge_e36hez.macroexpand(gensym_2_gmjsuzge_e36hf0.replace({_f:bound?gensym_2_gmjsuzge_e36hf1:gensym_2_gmjsuzge_e36hf2})).replace({_v:v.as('(')[0],_b:b}),_f:f})}),l_cps_def=(function (t,form,bound){return (function (inductive,base){return t.rmacro(gensym_2_gmjsuzge_e36hf4.replace({_form:form}),inductive).rmacro(gensym_2_gmjsuzge_e36hf5.parse(('let/'+(form.serialize())+'[_, _ <- _] in _')),inductive).rmacro(gensym_2_gmjsuzge_e36hf6.replace({_form:form}),base).rmacro(gensym_2_gmjsuzge_e36hf7.parse(('let/'+(form.serialize())+'[   _ <- _] in _')),base).rmacro(gensym_2_gmjsuzge_e36hf8.replace({_form:form}),inductive).rmacro(gensym_2_gmjsuzge_e36hf9.parse(('let/'+(form.serialize())+'[_, _ <- _][_]')),inductive).rmacro(gensym_2_gmjsuzge_e36hfa.replace({_form:form}),base).rmacro(gensym_2_gmjsuzge_e36hfb.parse(('let/'+(form.serialize())+'[   _ <- _][_]')),base)}).call(this,(function (cs,v,f,b){return gensym_2_gmjsuzge_e36hf3.replace({cs:cs,_f:cps_convert(v,f,b,bound)})}),(function (v,f,b){return cps_convert(v,f,b,bound)}))}),cps_def=(function (t,form,bound){return t.rmacro(gensym_2_gmjsuzge_e36hfc.replace({_form:form}),(function (f,b){return gensym_2_gmjsuzge_e36hfd.replace({_form:form,_f:f,_b:b})})).rmacro(gensym_2_gmjsuzge_e36hfe.replace({_form:form}),(function (f,v,b){return gensym_2_gmjsuzge_e36hff.replace({_c:gensym_2_gmjsuzge_e36hfg.macroexpand(gensym_2_gmjsuzge_e36hfh.replace({_f:bound?gensym_2_gmjsuzge_e36hfi:gensym_2_gmjsuzge_e36hfj})).replace({_v:v,_b:b}),_f:f})}))});
return ((function (_){return cps_def(_,gensym_2_gmjsuzge_e36hfk,false),cps_def(_,gensym_2_gmjsuzge_e36hfl,true),l_cps_def(_,gensym_2_gmjsuzge_e36hfm,false),l_cps_def(_,gensym_2_gmjsuzge_e36hfn,true),_})).call(this,this.configure('std.fn continuation.core'))}).call(this)})})())).tconfiguration('std','continuation.delimited',caterwaul.precompiled_internal((function (){var gensym_2_gmjsuzge_e36hfp=caterwaul.parse('call/cc[_]');
var gensym_2_gmjsuzge_e36hfq=caterwaul.parse('qg[caterwaul.continuation.call_cc.call(this,_f)]');
var gensym_2_gmjsuzge_e36hfr=caterwaul.parse('call/tail[_(_)]');
var gensym_2_gmjsuzge_e36hfs=caterwaul.parse('qg[caterwaul.continuation.call_tail.call(_f,_args)]');
return (function (gensym_2_gmjsuzge_e36hel){(function (magic){return ((function (_){return _.call_cc=function (f,gensym_2_gmjsuzge_e36hem){var escaped=false,cc=function (x,gensym_2_gmjsuzge_e36hen){escaped=true;
throw x},frame={magic:magic,continuation:f,parameters:[cc]};
try {while ((frame=frame.continuation.apply(this,frame.parameters))&&frame&&frame.magic===magic);
return frame}catch (e){if (escaped)return e;
else throw e}},_.call_tail=(function (){return {magic:magic,continuation:this,parameters:arguments}}),_})).call(this,this.continuation)}).call(this,this.configure('std.qg continuation.core').continuation.magic=this.magic('continuation.delimited'));
this.rmacro(gensym_2_gmjsuzge_e36hfp,(function (f){return gensym_2_gmjsuzge_e36hfq.replace({_f:f})})).rmacro(gensym_2_gmjsuzge_e36hfr,(function (f,args){return gensym_2_gmjsuzge_e36hfs.replace({_f:f,_args:args})}))})})())).configuration('continuation',function (gensym_2_gmjsuzge_e36heo){this.configure('continuation.core continuation.unwind continuation.cps continuation.delimited')});
