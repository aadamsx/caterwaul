Map tests.

test(function () {
  var c = caterwaul.clone('std iter seq');

  c(function (eq) {
    var naturals = x + 1 <sa< [0];
    var evens    = x * 2 <sm< naturals;
    eq(evens.length, naturals.length);
    eq(evens.at(0), 0);
    eq(evens.at(1), 2);
    eq(evens.at(10), 20);
  })(eq);

  c(function (eq) {
    var odds  = (x + 2 <sa< [0]).map(fn[x][x + 1]);
    var odds2 = x + 2 <sa< [1];
    var odds3 = x + 1 <sm< sa<< [0, 2, 4, 6, 8, 10, 12, 14, 16, 18, 20];

    iter.n[i, 10][eq(odds.at(i), odds2.at(i))];
    iter.n[i, 10][eq(odds.at(i), odds3.at(i))];
  })(eq);

  c(function (eq) {
    var empty = sa<< [];
    var mapped = x + 1 <sm< empty;

    eq(empty.length, 0);
    eq(empty.at(0), undefined);

    eq(mapped.length, 0);
    eq(mapped.at(0), undefined);

    eq(mapped.force().length, 0);
  })(eq);
});
